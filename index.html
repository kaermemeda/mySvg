<!DOCTYPE html>
<html>

<head>
    <title>SVG.js</title>
    <style>

    </style>
</head>

<body>
    <script type="text/javascript" src="d3.js"></script>
    <script type="text/javascript" src="d3-sankey.js"></script>
    <svg width="960" height="500"></svg>
    <script>
        var data = {
            nodes: [
                {
                    name: "Agricultural 'waste'"
                },
                {
                    name: "Bio-conversion"
                },
                {
                    name: "Liquid"
                },
                {
                    name: "Losses"
                },
                {
                    name: "Solid"
                },
                {
                    name: "Gas"
                },
                {
                    name: "Biofuel imports"
                },
                {
                    name: "Biomass imports"
                },
                {
                    name: "Coal imports"
                },
                {
                    name: "Coal"
                },
                {
                    name: "Coal reserves"
                },
                {
                    name: "District heating"
                },
                {
                    name: "Industry"
                },
                {
                    name: "Heating and cooling - commercial"
                },
                {
                    name: "Heating and cooling - homes"
                },
                {
                    name: "Electricity grid"
                },
                {
                    name: "Over generation / exports"
                },
                {
                    name: "H2 conversion"
                },
                {
                    name: "Road transport"
                },
                {
                    name: "Agriculture"
                },
                {
                    name: "Rail transport"
                },
                {
                    name: "Lighting & appliances - commercial"
                },
                {
                    name: "Lighting & appliances - homes"
                },
                {
                    name: "Gas imports"
                },
                {
                    name: "Ngas"
                },
                {
                    name: "Gas reserves"
                },
                {
                    name: "Thermal generation"
                },
                {
                    name: "Geothermal"
                },
                {
                    name: "H2"
                },
                {
                    name: "Hydro"
                },
                {
                    name: "International shipping"
                },
                {
                    name: "Domestic aviation"
                },
                {
                    name: "International aviation"
                },
                {
                    name: "National navigation"
                },
                {
                    name: "Marine algae"
                },
                {
                    name: "Nuclear"
                },
                {
                    name: "Oil imports"
                },
                {
                    name: "Oil"
                },
                {
                    name: "Oil reserves"
                },
                {
                    name: "Other waste"
                },
                {
                    name: "Pumped heat"
                },
                {
                    name: "Solar PV"
                },
                {
                    name: "Solar Thermal"
                },
                {
                    name: "Solar"
                },
                {
                    name: "Tidal"
                },
                {
                    name: "UK land based bioenergy"
                },
                {
                    name: "Wave"
                },
                {
                    name: "Wind"
                }
            ],
            links: [
                {
                    source: 0,
                    target: 1,
                    value: 50
                },
                {
                    source: 1,
                    target: 2,
                    value: 50
                },
                {
                    source: 1,
                    target: 3,
                    value: 50
                },
                {
                    source: 1,
                    target: 4,
                    value: 50
                },
                {
                    source: 1,
                    target: 5,
                    value: 50
                },
                {
                    source: 6,
                    target: 2,
                    value: 50,
                    source: 7,
                    target: 4,
                    value: 50,
                    source: 8,
                    target: 9,
                    value: 50
                },
                {
                    source: 10,
                    target: 9,
                    value: 50
                },
                {
                    source: 9,
                    target: 4,
                    value: 50
                },
                {
                    source: 11,
                    target: 12,
                    value: 50
                },
                {
                    source: 11,
                    target: 13,
                    value: 50
                },
                {
                    source: 11,
                    target: 14,
                    value: 50
                },
                {
                    source: 15,
                    target: 16,
                    value: 50
                },
                {
                    source: 15,
                    target: 14,
                    value: 50
                },
                {
                    source: 15,
                    target: 17,
                    value: 50
                },
                {
                    source: 15,
                    target: 12,
                    value: 50
                },
                {
                    source: 15,
                    target: 18,
                    value: 50
                },
                {
                    source: 15,
                    target: 19,
                    value: 50
                },
                {
                    source: 15,
                    target: 13,
                    value: 50
                },
                {
                    source: 15,
                    target: 3,
                    value: 50
                },
                {
                    source: 15,
                    target: 20,
                    value: 50
                },
                {
                    source: 15,
                    target: 21,
                    value: 50
                },
                {
                    source: 15,
                    target: 22,
                    value: 50
                },
                {
                    source: 23,
                    target: 24,
                    value: 50
                },
                {
                    source: 25,
                    target: 24,
                    value: 50
                },
                {
                    source: 5,
                    target: 13,
                    value: 50
                },
                {
                    source: 5,
                    target: 3,
                    value: 50
                },
                {
                    source: 5,
                    target: 26,
                    value: 50
                },
                {
                    source: 5,
                    target: 19,
                    value: 50
                },
                {
                    source: 5,
                    target: 12,
                    value: 50
                },
                {
                    source: 27,
                    target: 15,
                    value: 50
                },
                {
                    source: 17,
                    target: 28,
                    value: 50
                },
                {
                    source: 17,
                    target: 3,
                    value: 50
                },
                {
                    source: 28,
                    target: 18,
                    value: 50
                },
                {
                    source: 29,
                    target: 15,
                    value: 50
                },
                {
                    source: 2,
                    target: 12,
                    value: 50
                },
                {
                    source: 2,
                    target: 30,
                    value: 50
                },
                {
                    source: 2,
                    target: 18,
                    value: 50
                },
                {
                    source: 2,
                    target: 31,
                    value: 50
                },
                {
                    source: 2,
                    target: 32,
                    value: 50
                },
                {
                    source: 2,
                    target: 19,
                    value: 50
                },
                {
                    source: 2,
                    target: 33,
                    value: 50
                },
                {
                    source: 2,
                    target: 20,
                    value: 50
                },
                {
                    source: 34,
                    target: 1,
                    value: 50
                },
                {
                    source: 24,
                    target: 5,
                    value: 50
                },
                {
                    source: 35,
                    target: 26,
                    value: 50
                },
                {
                    source: 36,
                    target: 37,
                    value: 50
                },
                {
                    source: 38,
                    target: 37,
                    value: 50
                },
                {
                    source: 37,
                    target: 2,
                    value: 50
                },
                {
                    source: 39,
                    target: 4,
                    value: 50
                },
                {
                    source: 39,
                    target: 1,
                    value: 50
                },
                {
                    source: 40,
                    target: 14,
                    value: 50
                },
                {
                    source: 40,
                    target: 13,
                    value: 50
                },
                {
                    source: 41,
                    target: 15,
                    value: 50
                },
                {
                    source: 42,
                    target: 14,
                    value: 50
                },
                {
                    source: 43,
                    target: 42,
                    value: 50
                },
                {
                    source: 43,
                    target: 41,
                    value: 50
                },
                {
                    source: 4,
                    target: 19,
                    value: 50
                },
                {
                    source: 4,
                    target: 26,
                    value: 50
                },
                {
                    source: 4,
                    target: 12,
                    value: 50
                },
                {
                    source: 26,
                    target: 15,
                    value: 50
                },
                {
                    source: 26,
                    target: 3,
                    value: 50
                },
                {
                    source: 26,
                    target: 11,
                    value: 50
                },
                {
                    source: 44,
                    target: 15,
                    value: 50
                },
                {
                    source: 45,
                    target: 1,
                    value: 50
                },
                {
                    source: 46,
                    target: 15,
                    value: 50
                },
                {
                    source: 47,
                    target: 15,
                    value: 50
                }
            ]
        };
        var svg = d3.select("svg"),
            width = +svg.attr("width"),
            height = +svg.attr("height");

        var formatNumber = d3.format(",.0f"),
            format = function (d) { return formatNumber(d) + " TWh"; },
            color = d3.scaleOrdinal(d3.schemeCategory10);

        var sankey = d3.sankey()
            .nodeWidth(15)
            .nodePadding(10)
            .extent([[1, 1], [width - 1, height - 6]]);

        var link = svg.append("g")
            .attr("class", "links")
            .attr("fill", "none")
            .attr("stroke", "#000")
            .attr("stroke-opacity", 0.2)
            .selectAll("path");

        var node = svg.append("g")
            .attr("class", "nodes")
            .attr("font-family", "sans-serif")
            .attr("font-size", 10)
            .selectAll("g");
        draw(data);
        function draw(energy) {
            sankey(energy);
            link = link
                .data(energy.links)
                .enter().append("path")
                .attr("d", d3.sankeyLinkHorizontal())
                .attr("stroke-width", 2);

            link.append("title")
                .text(function (d) { return d.source.name + " → " + d.target.name + "\n" + format(d.value); });
            node = node
                .data(energy.nodes)
                .enter().append("g");
            node.append("rect")
                .attr("x", function (d) { return d.x0; })
                .attr("y", function (d) { return d.y0; })
                .attr("height", function (d) { return d.y1 - d.y0; })
                .attr("width", function (d) { return d.x1 - d.x0; })
                .attr("fill", function (d) { return color(d.name.replace(/ .*/, "")); })
                .attr("stroke", "#000");
            node.append("text")
                .attr("x", function (d) { return d.x0 - 6; })
                .attr("y", function (d) { return (d.y1 + d.y0) / 2; })
                .attr("dy", "0.35em")
                .attr("text-anchor", "end")
                .text(function (d) { return d.name; })
                .filter(function (d) { return d.x0 < width / 2; })
                .attr("x", function (d) { return d.x1 + 6; })
                .attr("text-anchor", "start");
            node.append("title")
                .text(function (d) { return d.name + "\n" + format(d.value); });
        }
    </script>
</body>

</html>